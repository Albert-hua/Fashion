<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ColorWear - Fashion Store</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fff; color: #333; margin: 0; padding: 0; }
    header { background: linear-gradient(to right, #f43f5e, #3b82f6); color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
    h1 { font-size: 1.5rem; }
    .lang-toggle { background: #fff; color: #333; padding: 0.3rem 0.6rem; border-radius: 4px; cursor: pointer; font-weight: bold; }
    .products { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; padding: 2rem; }
    .product { border: 1px solid #eee; border-radius: 8px; padding: 1rem; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .product img { max-width: 100%; border-radius: 8px; }
    .product select, .product button { margin-top: 0.5rem; padding: 0.4rem 0.8rem; }
    .cart-btn { display: block; margin: 2rem auto; background: #f43f5e; color: #fff; padding: 0.6rem 1.2rem; border: none; border-radius: 5px; cursor: pointer; }
    .cart-modal { display: none; position: fixed; top: 10%; left: 50%; transform: translateX(-50%); background: white; padding: 2rem; border: 1px solid #ccc; box-shadow: 0 0 10px rgba(0,0,0,0.15); max-width: 400px; width: 90%; z-index: 999; }
    .cart-modal input, .cart-modal textarea { width: 100%; margin: 0.5rem 0; padding: 0.5rem; }
    .cart-modal button { margin: 0.3rem 0.3rem; padding: 0.5rem 1rem; }
    .cart-modal ul { padding-left: 1rem; }
    #historyList { margin: 1rem auto; max-width: 600px; padding: 1rem; background: #f3f3f3; border-radius: 8px; }
    @media screen and (max-width: 500px) {
      header, .cart-modal, .products { padding: 1rem; }
      .product h3, .product p { font-size: 1rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>ColorWear</h1>
    <div>
      <button class="lang-toggle" onclick="toggleLang()">EN / 中文</button>
      <button class="cart-btn" onclick="showCart()">🛒 <span data-i18n="viewCart">View Cart</span></button>
    </div>
  </header>

  <section class="products">
    <div class="product">
      <img src="https://via.placeholder.com/220x220/FF4D4D/FFFFFF?text=Red+Shirt" />
      <h3 data-i18n="product1">Sunset Shirt</h3>
      <p>$29</p>
      <select id="size1">
        <option value="S">S</option><option value="M">M</option><option value="L">L</option>
      </select><br>
      <button onclick="addToCart('Sunset Shirt', 'size1', 29)">Add to Cart</button>
    </div>
    <div class="product">
      <img src="https://via.placeholder.com/220x220/3B82F6/FFFFFF?text=Blue+Tee" />
      <h3 data-i18n="product2">Wave Tee</h3>
      <p>$24</p>
      <select id="size2">
        <option value="S">S</option><option value="M">M</option><option value="L">L</option>
      </select><br>
      <button onclick="addToCart('Wave Tee', 'size2', 24)">Add to Cart</button>
    </div>
  </section>

  <div class="cart-modal" id="cartModal">
    <h3>🧾 <span data-i18n="orderDetails">Order Details</span></h3>
    <p id="orderIdText" style="font-weight:bold;"></p>
    <ul id="cartList"></ul>
    <input type="text" id="orderName" placeholder="Name / 姓名" />
    <input type="text" id="orderPhone" placeholder="Phone / 电话" />
    <input type="text" id="orderAddress" placeholder="Address / 地址" />
    <textarea id="orderNote" placeholder="Notes / 备注"></textarea>
    <a id="whatsappLink" href="#" target="_blank">
      <button onclick="generateOrderMessage('wa')">📩 WhatsApp</button>
    </a>
    <a id="telegramLink" href="#" target="_blank">
      <button onclick="generateOrderMessage('tg')">📨 Telegram</button>
    </a>
    <a href="https://yourpaymentlink.com" target="_blank">
      <button>💳 Pay Online</button>
    </a><br><br>
    <button onclick="hideCart()">Close</button>
  </div>

  <section id="historyList">
    <h3>📜 <span data-i18n="orderHistory">Order History</span></h3>
    <ul id="historyUl"></ul>
  </section>

  <script>
    let currentLang = 'en';
    const cart = [];

    const translations = {
      en: {
        viewCart: "View Cart",
        orderDetails: "Order Details",
        orderHistory: "Order History",
        product1: "Sunset Shirt",
        product2: "Wave Tee"
      },
      zh: {
        viewCart: "购物车",
        orderDetails: "订单详情",
        orderHistory: "历史订单",
        product1: "日落衬衫",
        product2: "海蓝T恤"
      }
    };

    function toggleLang() {
      currentLang = currentLang === 'en' ? 'zh' : 'en';
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = translations[currentLang][key];
      });
    }

    function addToCart(name, sizeSelectId, price) {
      const size = document.getElementById(sizeSelectId).value;
      cart.push(`${name} / Size: ${size} / $${price}`);
      alert("✅ Added to cart");
    }

    function generateOrderID() {
      const date = new Date();
      const ymd = date.toISOString().slice(0, 10).replace(/-/g, '');
      const random = Math.floor(Math.random() * 9000 + 1000);
      const orderId = `CW-${ymd}-${random}`;
      localStorage.setItem('lastOrderId', orderId);
      return orderId;
    }

    function showCart() {
      const list = document.getElementById("cartList");
      list.innerHTML = "";
      cart.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        list.appendChild(li);
      });

      const orderID = generateOrderID();
      document.getElementById("orderIdText").textContent = `🧾 Order ID: ${orderID}`;
      document.getElementById("cartModal").setAttribute("data-order-id", orderID);
      document.getElementById("cartModal").style.display = "block";
    }

    function hideCart() {
      document.getElementById("cartModal").style.display = "none";
    }

    function generateOrderMessage(platform) {
      const name = document.getElementById('orderName').value.trim();
      const phone = document.getElementById('orderPhone').value.trim();
      const address = document.getElementById('orderAddress').value.trim();
      const note = document.getElementById('orderNote').value.trim();

      if (!name || !phone || !address) {
        alert("❗Please fill in Name, Phone, and Address before ordering.");
        return;
      }

      const orderID = document.getElementById("cartModal").getAttribute("data-order-id") || generateOrderID();

      let message = `🧾 Order ID: ${orderID}%0AHello, I want to order:%0A`;
      cart.forEach(item => {
        message += `- ${item}%0A`;
      });
      message += `%0AName: ${name}%0APhone: ${phone}%0AAddress: ${address}%0ANotes: ${note || '-'}`;

      const encoded = encodeURI(message);
      const orderRecord = `${orderID} - ${name} - ${cart.length} items`;
      saveOrderHistory(orderRecord);

      if (platform === 'wa') {
        document.getElementById("whatsappLink").href = `https://wa.me/85512345678?text=${encoded}`;
      } else {
        document.getElementById("telegramLink").href = `https://t.me/your_telegram_username?text=${encoded}`;
      }
    }

    function saveOrderHistory(record) {
      const ul = document.getElementById("historyUl");
      const li = document.createElement("li");
      li.textContent = record;
      ul.appendChild(li);
      const history = JSON.parse(localStorage.getItem("orderHistory") || "[]");
      history.push(record);
      localStorage.setItem("orderHistory", JSON.stringify(history));
    }

    window.onload = function() {
      toggleLang(); // 默认切换一次语言
      const history = JSON.parse(localStorage.getItem("orderHistory") || "[]");
      const ul = document.getElementById("historyUl");
      history.forEach(record => {
        const li = document.createElement("li");
        li.textContent = record;
        ul.appendChild(li);
      });
    };
  </script>
</body>
</html>
